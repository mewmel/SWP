<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trang chủ Bác sĩ - Hệ thống quản lý</title>
    <link rel="stylesheet" href="css/doctor-common.css">
    <link rel="stylesheet" href="css/bac-si-dashboard.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>

<body>
<!-- Header Navigation -->
<header class="doctor-header">
    <div class="doctor-header-container">
        <nav class="doctor-nav">
            <a href="bac-si-dashboard.html" class="nav-link">Trang cá nhân</a>
            <a href="blog.html" class="nav-link">Đăng Blog</a>
            <a href="bac-si-lich-lam-viec.html" class="nav-link">Xem lịch làm</a>
            <a href="bac-si-profile.html" class="nav-link active">Hồ sơ cá nhân</a>
        </nav>

        <div class="doctor-header-right">
            <div class="notification-wrapper" style="position: relative;">
                <button class="doctor-notification-btn">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"></path>
                        <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                    </svg>
                    <span class="doctor-notification-badge">3</span>
                </button>
            </div>

            <div class="doctor-profile-info">
                <div class="doctor-info">
                    <div class="doctor-name">BS. Nguyễn Ngọc Khánh Linh</div>
                    <div class="doctor-role">Quản trị viên</div>
                </div>
                <div class="doctor-avatar">
                    <i class="fas fa-user"></i>
                </div>
            </div>

            <button class="logout-btn" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i>
            </button>

            <button class="doctor-mobile-menu">
                <i class="fas fa-bars"></i>
            </button>
        </div>
    </div>
</header>
    <div class="doctor-page-container">
        <div class="container">
            <!-- Main Content -->
            <main class="main-content">
                <div class="schedule-section">
                    <div class="schedule-header">
                        <h2>Lịch trình hôm nay</h2>
                        <span class="current-date"></span>
                    </div>
                    <div class="schedule-list">
                        <div class="appointment-item" data-patient="" data-status="">
                            <div class="time" type="time"></div>
                            <div class="appointment-info">
                                <h3>BN: <span class="patient-name"></span></h3>
                                <p class="service-name"></p>
                                <span class="status-badge"></span>
                            </div>
                            <div class="appointment-actions">
                                <i class="fas fa-file-medical"></i> Xem hồ sơ
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
            <!-- Sidebar -->
            <aside class="sidebar">
                <div class="sidebar-section">
                    <h3 class="sidebar-title">
                        <i class="fas fa-users"></i>
                        Quản lý bệnh nhân
                    </h3>
                    <div class="sidebar-menu">
                        <button class="sidebar-item" onclick="window.openPatientList()">
                            <i class="fas fa-list"></i>
                            <span>Xem danh sách bệnh nhân</span>
                        </button>
                        <button class="sidebar-item" onclick="openScheduleManager()">
                            <i class="fas fa-calendar"></i>
                            <span>Quản lý lịch hẹn</span>
                        </button>
                    </div>
                </div>
            </aside>
        </div>

        <!-- Modal for Patient Record -->
        <div id="patientModal" class="modal">
            <div class="modal-content large-modal">
                <div class="modal-header">
                    <h3><i class="fas fa-file-medical"></i> Hồ sơ bệnh án</h3>
                    <span class="close" onclick="window.closeModal()">&times;</span>
                </div>
                <div class="modal-body">
                    <!-- Patient Basic Info -->
                    <div class="patient-info-section">
                        <div class="patient-header">
                            <div class="patient-avatar">
                                <i class="fas fa-user"></i>
                            </div>
                            <div class="patient-details">
                                <h4 id="patientName"></h4>
                                <p class="patient-id">Mã BN: <span id="cusId"></span></p>
                            </div>
                            <div class="patient-status">
                                <span class="status-badge" id="currentStatus"></span>
                            </div>
                        </div>

                        <div class="info-grid">
                            <div class="info-row">
                                <div class="info-item">
                                    <label><i class="fas fa-venus-mars"></i> Giới tính:</label>
                                    <span id="patientGender"></span>
                                </div>
                                <div class="info-item">
                                    <label><i class="fas fa-birthday-cake"></i> Ngày sinh:</label>
                                    <span id="patientBirthDate"></span>
                                </div>
                            </div>
                            <div class="info-row">
                                <div class="info-item">
                                    <label><i class="fas fa-phone"></i> Số điện thoại:</label>
                                    <span id="patientPhone"></span>
                                </div>
                                <div class="info-item">
                                    <label><i class="fas fa-envelope"></i> Email:</label>
                                    <span id="patientEmail"></span>
                                </div>
                            </div>
                            <div class="info-row">
                                <div class="info-item">
                                    <label><i class="fas fa-map-marker-alt"></i> Địa chỉ:</label>
                                    <span id="patientAddress"></span>
                                </div>
                                <div class="info-item">
                                    <label><i class="fas fa-briefcase"></i> Nghề nghiệp:</label>
                                    <span id="patientOccupation"></span>
                                </div>
                            </div>
                            <div class="info-row">
                                <div class="info-item">
                                    <label><i class="fas fa-phone-alt"></i> Liên hệ khẩn cấp:</label>
                                    <span id="emergencyContact"></span>
                                </div>
                                <div class="info-item">
                                    <label><i class="fas fa-user-check"></i> Trạng thái:</label>
                                    <span id="patientStatus" class="status-active">Hoạt động</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Medical Record Tabs -->
                    <div class="record-tabs">
                        <button class="tab-btn active" onclick="window.switchTab('current')">Khám hôm nay</button>
                        <!-- <button class="tab-btn" onclick="window.switchTab('history')">Lịch sử khám</button>
                        <button class="tab-btn" onclick="window.switchTab('treatment')">Điều trị</button> -->
                        <button class="tab-btn" onclick="window.switchTab('prescription')">Kê thuốc</button>
                        <button class="tab-btn" onclick="window.switchTab('tests')">Xét nghiệm</button>
                    </div>

                    <!-- Current Examination Tab -->
                    <div id="currentTab" class="tab-content active">
                        <div class="medical-record">
                            <h4><i class="fas fa-stethoscope"></i> Khám bệnh hôm nay</h4>

                            <!-- Booking Information -->
                            <div class="booking-info">
                                <h5><i class="fas fa-calendar-check"></i> Thông tin lịch hẹn</h5>
                                <div class="record-grid">
                                    <div class="record-section">
                                        <label>Loại đặt lịch:</label>
                                        <select id="bookType">
                                            <option value="initial">Khám lần đầu</option>
                                            <option value="follow-up">Tái khám</option>
                                        </select>
                                    </div>
                                    <div class="record-section">
                                        <label>Trạng thái lịch hẹn:</label>
                                        <select id="bookStatus">
                                            <option value="completed">Đã đến khám</option>
                                            <option value="pending">Chưa đến khám</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="record-section">
                                    <label>Ghi chú lịch hẹn:</label>
                                    <textarea id="bookingNote" rows="2" placeholder="Ghi chú về lịch hẹn..."></textarea>
                                </div>
                            </div>

                            <!-- Medical Record Information -->
                            <div class="medical-record-info">
                                <h5><i class="fas fa-file-medical-alt"></i> Hồ sơ bệnh án</h5>
                                <div class="record-grid">
                                    <div class="record-section">
                                        <label>Trạng thái hồ sơ:</label>
                                        <select id="recordStatus">
                                            <option value="active" selected>Đang điều trị</option>
                                            <option value="pending">Chờ xử lý</option>
                                            <option value="closed">Đã kết thúc</option>
                                        </select>
                                    </div>
                                    <div class="record-section">
                                        <label>Ngày tạo hồ sơ:</label>
                                        <input type="datetime-local" id="recordCreatedDate">
                                    </div>
                                </div>

                                <div class="record-section">
                                    <label>Dịch vụ:</label>
                                    <span id="serviceName" rows="3"></span>
                                </div>
                                <div class="record-section">
                                    <label>Chẩn đoán:</label>
                                    <textarea id="diagnosis" rows="4" placeholder="Nhập chẩn đoán..."></textarea>
                                </div>

                                <div class="record-section">
                                    <label>Kế hoạch điều trị:</label>
                                    <textarea id="treatmentPlan" rows="5"
                                        placeholder="Mô tả kế hoạch điều trị..."></textarea>
                                </div>

                                <div class="record-section">
                                    <label>Ngày dự kiến kết thúc điều trị:</label>
                                    <input type="datetime-local" id="dischargeDate">
                                </div>

                                <div class="record-section">
                                    <label>Ghi chú hồ sơ:</label>
                                    <textarea id="medicalNote" rows="3"
                                        placeholder="Ghi chú chung về hồ sơ..."></textarea>
                                </div>
                            </div>
                            <!-- Booking Steps -->
                            <div class="booking-steps">
                                <h5><i class="fas fa-list-ol"></i> Quản lý các bước điều trị</h5>
                                <!-- Service Selection -->
                                <div class="service-selection">
                                    <div class="service-dropdown-container">
                                        <label for="serviceSelect"><i class="fas fa-medical-bag"></i> Chọn dịch vụ/bước
                                            cần thực hiện:</label>
                                        <select id="serviceSelect" class="service-dropdown">
                                            <option value="">-- Chọn dịch vụ --</option>
                                        </select>
                                    </div>
                                </div>

                                <!-- Step Form (Hidden by default) -->
                                <div class="step-form" id="stepForm" style="display: none;">
                                    <div class="form-header">
                                        <h6 id="selectedServiceTitle"><i class="fas fa-edit"></i> Thực hiện: </h6>
                                        <span class="form-badge">Đang thực hiện</span>
                                    </div>
                                    <div class="step-form-content">
                                        <div class="record-grid">
                                            <div class="record-section">
                                                <label>Ngày & giờ thực hiện:</label>
                                                <input type="datetime-local" id="performedAt" class="form-control">
                                            </div>
                                            <div class="record-section">
                                                <label>Trạng thái:</label>
                                                <select id="stepStatus" class="form-control">
                                                    <option value="pending">Đang thực hiện</option>
                                                    <option value="completed">Đã hoàn thành</option>
                                                    <option value="inactive">Không hoạt động</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="record-section">
                                            <label>Kết quả thực hiện:</label>
                                            <textarea rows="3" placeholder="Mô tả kết quả, chỉ số, tình trạng..."
                                                id="stepResult" class="form-control"></textarea>
                                        </div>
                                        <div class="record-section">
                                            <label>Ghi chú của bác sĩ:</label>
                                            <textarea rows="2" placeholder="Lưu ý, khuyến nghị, hướng dẫn..."
                                                id="stepNote" class="form-control"></textarea>
                                        </div>
                                        <div class="form-actions">
                                            <button type="button" class="btn-save-step" onclick="saveBookingStep()">
                                                <i class="fas fa-save"></i> Lưu bước này
                                            </button>
                                            <button type="button" class="btn-cancel-step" onclick="cancelStepForm()">
                                                <i class="fas fa-times"></i> Hủy
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <!-- Completed Steps List -->
                                <div class="completed-steps">
                                    <h6><i class="fas fa-check-circle"></i> Các bước đã thực hiện</h6>
                                    <div class="steps-list" id="completedStepsList">
                                        <!-- NODE TEMPLATE ẨN -->
                                        <div class="step-item step-template" style="display:none" data-step-id=""
                                            data-sub-id="" data-sub-name="">
                                            <div class="step-header">
                                                <div class="step-info">
                                                    <strong></strong>
                                                    <span class="step-time"></span>
                                                </div>
                                                <div class="step-actions">
                                                    <span class="step-status"></span>
                                                    <button class="btn-edit-step"><i class="fas fa-edit"></i></button>
                                                </div>
                                            </div>
                                            <div class="step-summary">
                                                <p><strong>Kết quả:</strong> <span class="step-result"></span></p>
                                                <p><strong>Ghi chú:</strong> <span class="step-note"></span></p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="empty-steps" id="emptySteps" style="display: none;">
                                        <i class="fas fa-clipboard-list"></i>
                                        <p>Chưa có bước nào được thực hiện</p>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>

                    <!-- Medical History Tab -->
                    <div id="historyTab" class="tab-content">
                        <div class="history-list">
                            <h4><i class="fas fa-history"></i> Lịch sử bệnh án</h4>
                            <!-- Medical Record 1 -->
                            <div class="history-item">
                                <div class="history-header">
                                    <div class="history-date"></div>
                                    <div class="history-status active"></div>
                                </div>
                                <div class="history-content">
                                    <div class="history-info">
                                        <p><strong>Mã hồ sơ:</strong> MR002</p>
                                        <p><strong>Dịch vụ:</strong> Liệu trình điều trị IVF</p>
                                        <p><strong>Bác sĩ điều trị:</strong> BS. Nguyễn Ngọc Khánh Linh</p>
                                    </div>
                                    <div class="history-details">
                                        <p><strong>Chẩn đoán:</strong></p>
                                        <p><strong>Kế hoạch điều trị:</strong></p>
                                        <p><strong>Ngày dự kiến kết thúc:</strong></p>
                                    </div>
                                    <div class="history-notes">
                                        <p><strong>Ghi chú:</strong></p>
                                    </div>
                                </div>
                            </div>

                            <!-- Booking History -->
                            <div class="booking-history">
                                <h5><i class="fas fa-calendar-alt"></i> Lịch sử đặt lịch</h5>
                                <div class="booking-item">
                                    <div class="booking-header">
                                        <span class="booking-date">24/06/2024 08:00</span>
                                        <span class="booking-status confirmed">Đã xác nhận</span>
                                    </div>
                                    <div class="booking-details">
                                        <p><strong>Loại:</strong> Tái khám</p>
                                        <p><strong>Bác sĩ:</strong> BS. Nguyễn Ngọc Khánh Linh</p>
                                        <p><strong>Dịch vụ:</strong> Liệu trình điều trị IVF</p>
                                        <p><strong>Ghi chú:</strong> Bệnh nhân đến đúng giờ hẹn</p>
                                    </div>
                                </div>

                                <div class="booking-item">
                                    <div class="booking-header">
                                        <span class="booking-date">20/06/2024 09:00</span>
                                        <span class="booking-status confirmed">Đã xác nhận</span>
                                    </div>
                                    <div class="booking-details">
                                        <p><strong>Loại:</strong> Khám lần đầu</p>
                                        <p><strong>Bác sĩ:</strong> BS. Nguyễn Ngọc Khánh Linh</p>
                                        <p><strong>Dịch vụ:</strong> Khám tiền đăng ký điều trị (IVF/IUI)</p>
                                        <p><strong>Ghi chú:</strong> Tư vấn lần đầu</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Treatment Tab -->
                    <div id="treatmentTab" class="tab-content">
                        <div class="treatment-plan">
                            <h4><i class="fas fa-tasks"></i> Kế hoạch điều trị</h4>

                            <!-- Current Service -->
                            <div class="current-service">
                                <h5><i class="fas fa-medical-kit"></i> Dịch vụ hiện tại</h5>
                                <div class="service-info">
                                    <div class="service-card">
                                        <h6>Liệu trình điều trị IVF</h6>
                                        <p class="service-description">Quy trình thụ tinh trong ống nghiệm: kích
                                            thích
                                            buồng trứng, chọc hút noãn, thụ tinh và chuyển phôi</p>
                                        <div class="service-details">
                                            <span class="service-price">20.700.000 VNĐ</span>
                                            <span class="service-duration">30 ngày</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Sub Services -->
                            <div class="sub-services">
                                <h5><i class="fas fa-list-check"></i> Các bước điều trị chi tiết</h5>

                                <div class="sub-service-item completed">
                                    <div class="sub-service-header">
                                        <span class="step-number">1</span>
                                        <div class="sub-service-info">
                                            <h6>Kích thích buồng trứng</h6>
                                            <p>Tiêm thuốc, theo dõi nang noãn</p>
                                        </div>
                                        <div class="sub-service-details">
                                            <span class="estimated-day">Ngày 1</span>
                                            <span class="sub-price">600.000 VNĐ</span>
                                        </div>
                                        <span class="status-icon completed"><i class="fas fa-check-circle"></i></span>
                                    </div>
                                </div>

                                <div class="sub-service-item completed">
                                    <div class="sub-service-header">
                                        <span class="step-number">2</span>
                                        <div class="sub-service-info">
                                            <h6>Siêu âm noãn</h6>
                                            <p>Theo dõi nang noãn phát triển</p>
                                        </div>
                                        <div class="sub-service-details">
                                            <span class="estimated-day">Ngày 3</span>
                                            <span class="sub-price">250.000 VNĐ</span>
                                        </div>
                                        <span class="status-icon completed"><i class="fas fa-check-circle"></i></span>
                                    </div>
                                </div>

                                <div class="sub-service-item current">
                                    <div class="sub-service-header">
                                        <span class="step-number">3</span>
                                        <div class="sub-service-info">
                                            <h6>Tiêm hCG</h6>
                                            <p>Kích thích trưởng thành noãn, chuẩn bị chọc trứng</p>
                                        </div>
                                        <div class="sub-service-details">
                                            <span class="estimated-day">Ngày 8</span>
                                            <span class="sub-price">300.000 VNĐ</span>
                                        </div>
                                        <span class="status-icon current"><i class="fas fa-clock"></i></span>
                                    </div>
                                </div>

                                <div class="sub-service-item pending">
                                    <div class="sub-service-header">
                                        <span class="step-number">4</span>
                                        <div class="sub-service-info">
                                            <h6>Chọc hút trứng</h6>
                                            <p>Lấy trứng ra khỏi buồng trứng</p>
                                        </div>
                                        <div class="sub-service-details">
                                            <span class="estimated-day">Ngày 10</span>
                                            <span class="sub-price">7.000.000 VNĐ</span>
                                        </div>
                                        <span class="status-icon pending"><i class="fas fa-circle"></i></span>
                                    </div>
                                </div>

                                <div class="sub-service-item pending">
                                    <div class="sub-service-header">
                                        <span class="step-number">5</span>
                                        <div class="sub-service-info">
                                            <h6>Lấy tinh trùng</h6>
                                            <p>Lấy mẫu tinh trùng vào ngày chọc trứng</p>
                                        </div>
                                        <div class="sub-service-details">
                                            <span class="estimated-day">Ngày 10</span>
                                            <span class="sub-price">1.000.000 VNĐ</span>
                                        </div>
                                        <span class="status-icon pending"><i class="fas fa-circle"></i></span>
                                    </div>
                                </div>

                                <div class="sub-service-item pending">
                                    <div class="sub-service-header">
                                        <span class="step-number">6</span>
                                        <div class="sub-service-info">
                                            <h6>Tạo phôi, nuôi phôi trong lab</h6>
                                            <p>Nuôi cấy và chọn lọc phôi</p>
                                        </div>
                                        <div class="sub-service-details">
                                            <span class="estimated-day">Ngày 11</span>
                                            <span class="sub-price">5.000.000 VNĐ</span>
                                        </div>
                                        <span class="status-icon pending"><i class="fas fa-circle"></i></span>
                                    </div>
                                </div>

                                <div class="sub-service-item pending">
                                    <div class="sub-service-header">
                                        <span class="step-number">7</span>
                                        <div class="sub-service-info">
                                            <h6>Chuyển phôi</h6>
                                            <p>Đưa phôi vào buồng tử cung</p>
                                        </div>
                                        <div class="sub-service-details">
                                            <span class="estimated-day">Ngày 15</span>
                                            <span class="sub-price">6.000.000 VNĐ</span>
                                        </div>
                                        <span class="status-icon pending"><i class="fas fa-circle"></i></span>
                                    </div>
                                </div>

                                <div class="sub-service-item pending">
                                    <div class="sub-service-header">
                                        <span class="step-number">8</span>
                                        <div class="sub-service-info">
                                            <h6>Thử β-hCG</h6>
                                            <p>Xét nghiệm kiểm tra thai sau chuyển phôi</p>
                                        </div>
                                        <div class="sub-service-details">
                                            <span class="estimated-day">Ngày 22</span>
                                            <span class="sub-price">200.000 VNĐ</span>
                                        </div>
                                        <span class="status-icon pending"><i class="fas fa-circle"></i></span>
                                    </div>
                                </div>

                                <div class="sub-service-item pending">
                                    <div class="sub-service-header">
                                        <span class="step-number">9</span>
                                        <div class="sub-service-info">
                                            <h6>Siêu âm tim thai</h6>
                                            <p>Theo dõi sự phát triển của thai (nếu có)</p>
                                        </div>
                                        <div class="sub-service-details">
                                            <span class="estimated-day">Ngày 29</span>
                                            <span class="sub-price">350.000 VNĐ</span>
                                        </div>
                                        <span class="status-icon pending"><i class="fas fa-circle"></i></span>
                                    </div>
                                </div>
                            </div>

                            <!-- Treatment Summary -->
                            <div class="treatment-summary">
                                <h5><i class="fas fa-chart-pie"></i> Tổng quan điều trị</h5>
                                <div class="summary-grid">
                                    <div class="summary-item">
                                        <span class="summary-label">Tổng số bước:</span>
                                        <span class="summary-value">0</span>
                                    </div>
                                    <div class="summary-item">
                                        <span class="summary-label">Đã hoàn thành:</span>
                                        <span class="summary-value">0</span>
                                    </div>
                                    <div class="summary-item">
                                        <span class="summary-label">Đang thực hiện:</span>
                                        <span class="summary-value">0</span>
                                    </div>
                                    <!-- <div class="summary-item">
                                        <span class="summary-label">Tiến độ:</span>
                                        <span class="summary-value">22%</span>
                                    </div> -->
                                </div>
                                <!-- <div class="progress-bar">
                                    <div class="progress-fill" style="width: 22%"></div>
                                </div> -->
                            </div>
                        </div>
                    </div>

                    <!-- Prescription Tab -->
                    <div id="prescriptionTab" class="tab-content">
                        <div class="prescription-management">
                            <h4><i class="fas fa-pills"></i> Kê đơn thuốc</h4>

                            <!-- Prescription Header -->
                            <div class="prescription-header">
                                <div class="prescription-info">
                                    <div class="record-grid">
                                        <div class="record-section">
                                            <label><i class="fas fa-calendar-alt"></i> Ngày kê đơn:</label>
                                            <input type="datetime-local" id="prescriptionDate" class="form-control">
                                            <!--chỗ của createdAt -->
                                        </div>
                                        <div class="record-section">
                                            <label><i class="fas fa-user-md"></i> Bác sĩ kê đơn:</label>
                                            <input type="text" readonly class="form-control" id="prescribingDoctorName">
                                        </div>
                                    </div>
                                    <div class="record-grid">
                                        <div class="record-section">
                                            <label><i class="fas fa-hashtag"></i> Số đơn thuốc:</label>
                                            <input type="text" readonly class="form-control" id="prescriptionNumber">
                                            <!--chỗ của drugId -->
                                        </div>
                                    </div>
                                    <!-- <div class="record-section">
                                        <label><i class="fas fa-stethoscope"></i> Chẩn đoán liên quan:</label>
                                        <textarea rows="2" id="prescriptionDiagnosis" class="form-control"
                                            placeholder="Chẩn đoán liên quan đến đơn thuốc..."></textarea>  chỗ của drugNote
                                        
                                    </div> -->
                                </div>
                            </div>
                            <!-- Drug Prescription List -->
                            <div class="drug-prescription">
                                <div class="prescription-section-header">
                                    <h5><i class="fas fa-list-ul"></i> Danh sách thuốc kê đơn</h5>
                                    <button type="button" class="btn-add-drug" onclick="window.addDrugPrescription()">
                                        <i class="fas fa-plus"></i> Thêm thuốc
                                    </button>
                                </div>

                                <div class="drugs-list" id="drugsList">
                                    <!-- Drug Item -->
                                </div>
                            </div>

                            <!-- Prescription Summary -->
                            <div class="prescription-summary">
                                <h5><i class="fas fa-clipboard-check"></i> Tóm tắt đơn thuốc</h5>
                                <div class="summary-content">
                                    <div class="summary-stats">
                                        <div class="stat-item">
                                            <span class="stat-number">2</span>
                                            <span class="stat-label">Loại thuốc</span>
                                        </div>
                                    </div>
                                    <div class="prescription-notes">
                                        <label><i class="fas fa-notes-medical"></i> Lời dặn chung của bác sĩ:</label>
                                        <textarea rows="3" id="generalNotes" class="form-control"
                                            placeholder="Lời dặn tổng quát cho bệnh nhân về việc sử dụng thuốc...">Tuân thủ đúng liều dùng và thời gian. Báo với bác sĩ nếu có tác dụng phụ bất thường. Không tự ý ngừng thuốc mà không tham khảo ý kiến bác sĩ.</textarea>
                                    </div>
                                </div>
                            </div>

                            <!-- Prescription Actions -->
                            <div class="prescription-actions">
                                <button type="button" class="btn-secondary" onclick="window.previewPrescription()">
                                    <i class="fas fa-eye"></i> Xem trước đơn thuốc
                                </button>
                                <!-- <button type="button" class="btn-print" onclick="window.printPrescription()">
                                <i class="fas fa-print"></i> In đơn thuốc
                            </button> -->
                                <button type="button" class="btn-primary" onclick="window.savePrescription()">
                                    <i class="fas fa-save"></i> Lưu đơn thuốc
                                </button>
                            </div>
                        </div>
                    </div>
                    <!-- Tests Tab -->
                    <div id="testsTab" class="tab-content">
                        <div class="test-results">
                            <h4><i class="fas fa-flask"></i> Kết quả xét nghiệm </h4>
                            <!-- Booking Steps Results -->
                            <div class="booking-steps-results">
                                <h5><i class="fas fa-vial"></i> Kết quả các bước đã thực hiện</h5>
                                <div class="step-result-item">
                                    <div class="step-result-header">
                                        <div class="step-info">
                                            <h6 contenteditable="true" class="editable-title"></h6>
                                            <input type="datetime-local" class="editable-date">
                                        </div>
                                        <select class="step-status-select">
                                            <option value="completed" selected>Hoàn thành</option>
                                            <option value="pending">Đang chờ</option>
                                            <option value="cancelled">Đã hủy</option>
                                        </select>
                                    </div>
                                    <div class="step-result-content">
                                        <div class="result-grid">
                                            <div class="result-item">
                                                <input type="text" class="editable-label" value="Nồng độ"
                                                    placeholder="Tên chỉ số">:
                                                <input type="text" class="editable-result" value="45"
                                                    placeholder="Giá trị">
                                                <select class="unit-select">
                                                    <option value="triệu/ml" selected>triệu/ml</option>
                                                    <option value="mIU/ml">mIU/ml</option>
                                                    <option value="ng/ml">ng/ml</option>
                                                    <option value="pg/ml">pg/ml</option>
                                                    <option value="%">%</option>
                                                </select>
                                                <select class="status-select">
                                                    <option value="Bình thường" selected>Bình thường</option>
                                                    <option value="Cao">Cao</option>
                                                    <option value="Thấp">Thấp</option>
                                                    <option value="Bất thường">Bất thường</option>
                                                </select>
                                            </div>
                                            <div class="result-item">
                                                <input type="text" class="editable-label" value="Khả năng vận động"
                                                    placeholder="Tên chỉ số">:
                                                <input type="text" class="editable-result" value="65"
                                                    placeholder="Giá trị">
                                                <select class="unit-select">
                                                    <option value="%" selected>%</option>
                                                    <option value="mIU/ml">mIU/ml</option>
                                                    <option value="ng/ml">ng/ml</option>
                                                    <option value="pg/ml">pg/ml</option>
                                                    <option value="triệu/ml">triệu/ml</option>
                                                </select>
                                                <select class="status-select">
                                                    <option value="Bình thường" selected>Bình thường</option>
                                                    <option value="Cao">Cao</option>
                                                    <option value="Thấp">Thấp</option>
                                                    <option value="Bất thường">Bất thường</option>
                                                </select>
                                            </div>
                                            <div class="result-item">
                                                <input type="text" class="editable-label" value="Hình thái"
                                                    placeholder="Tên chỉ số">:
                                                <input type="text" class="editable-result" value="8"
                                                    placeholder="Giá trị">
                                                <select class="unit-select">
                                                    <option value="%" selected>%</option>
                                                    <option value="mIU/ml">mIU/ml</option>
                                                    <option value="ng/ml">ng/ml</option>
                                                    <option value="pg/ml">pg/ml</option>
                                                    <option value="triệu/ml">triệu/ml</option>
                                                </select>
                                                <select class="status-select">
                                                    <option value="Bình thường" selected>Bình thường</option>
                                                    <option value="Cao">Cao</option>
                                                    <option value="Thấp">Thấp</option>
                                                    <option value="Bất thường">Bất thường</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="result-note">
                                            <strong>Ghi chú:</strong>
                                            <textarea class="editable-note"
                                                placeholder="Nhập ghi chú...">Chất lượng tinh trùng tốt, phù hợp cho IVF</textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Add New Test Button -->
                            <div class="add-new-test-section">
                                <button type="button" class="add-test-item-btn" onclick="window.addNewTestItem()">
                                    <i class="fas fa-plus"></i>
                                    Thêm xét nghiệm mới
                                </button>
                            </div>

                            <!-- Test Summary -->
                            <!-- <div class="test-summary">
                                    <h5><i class="fas fa-chart-line"></i> Tổng kết xét nghiệm</h5>
                                    <div class="summary-card">
                                        <div class="summary-status success">
                                            <i class="fas fa-check-circle"></i>
                                            <span>Tất cả xét nghiệm đều bình thường</span>
                                        </div>
                                        <div class="summary-recommendation">
                                            <strong>Kết luận:</strong>
                                        </div>
                                        <div class="next-step">
                                            <strong>Bước tiếp theo:</strong>
                                        </div>
                                    </div>
                                </div> -->
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn-secondary" onclick="window.closeModal()">
                        <i class="fas fa-times"></i> Đóng
                    </button>
                    <button class="btn-print" onclick="window.printRecord()">
                        <i class="fas fa-print"></i> In hồ sơ
                    </button>
                    <button class="btn-primary" onclick="window.savePatientRecord()">
                        <i class="fas fa-save"></i> Lưu thay đổi
                    </button>
                </div>
            </div>
        </div>

        <!-- Patient List Modal -->
        <div id="patientListModal" class="modal">
            <div class="modal-content large">
                <div class="modal-header">
                    <h3>Danh sách bệnh nhân</h3>
                    <span class="close" onclick="window.closePatientListModal()">&times;</span>
                </div>
                <div class="modal-body">
                    <div class="search-box">
                        <input type="text" id="searchInput" placeholder="Tìm kiếm bệnh nhân..."
                            onkeyup="window.searchPatients()">
                        <i class="fas fa-search"></i>
                    </div>
                    <div class="patient-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>Tên bệnh nhân</th>
                                    <th>Tuổi</th>
                                    <th>Số điện thoại</th>
                                    <th>Lần khám gần nhất</th>
                                    <th>Thao tác</th>
                                </tr>
                            </thead>
                            <tbody id="patientTableBody">
                                <tr>
                                    <td>Phạm Thị Hoa</td>
                                    <td>30</td>
                                    <td>0456789123</td>
                                    <td>24/06/2024</td>
                                    <td>
                                        <button class="btn-small" onclick="window.editPatientFromList('hoa')">Sửa
                                            bệnh
                                            án</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="js/doctor-common.js"></script>
    <script src="js/script.js"></script>
    <script src="js/doctor-dashboard.js"></script>

</body>

</html>